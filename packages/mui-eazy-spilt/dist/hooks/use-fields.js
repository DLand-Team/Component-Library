import{j as e}from"../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js";import{yupResolver as o}from"../node_modules/.pnpm/@hookform_resolvers@3.3.1_react-hook-form@7.45.4/node_modules/@hookform/resolvers/yup/dist/yup.js";import{Stack as t}from"@mui/material";import r,{useState as i,useMemo as m}from"react";import{useForm as s}from"../node_modules/.pnpm/react-hook-form@7.45.4_react@18.2.0/node_modules/react-hook-form/dist/index.esm.js";import*as n from"yup";import"../node_modules/.pnpm/react-lazy-load-image-component@1.6.0_react-dom@18.2.0_react@18.2.0/node_modules/react-lazy-load-image-component/build/index.js";import"../node_modules/.pnpm/@iconify_react@4.1.1_react@18.2.0/node_modules/@iconify/react/dist/iconify.js";import"../components/upload/upload-drag/cropModal.js";import"../node_modules/.pnpm/mui-one-time-password-input@2.0.0_@emotion_react@11.5.0_@emotion_styled@11.6.0_@mui_material@_gz73w2mugfx3qywq7zx6asfuky/node_modules/mui-one-time-password-input/dist/mui-one-time-password-input.es.js";import"../utils/highlight.js";import"../node_modules/.pnpm/react-quill@2.0.0_react-dom@18.2.0_react@18.2.0/node_modules/react-quill/dist/quill.snow.css.js";import"../node_modules/.pnpm/react-quill@2.0.0_react-dom@18.2.0_react@18.2.0/node_modules/react-quill/lib/index.js";import"../components/editor/styles.js";import"../node_modules/.pnpm/react-google-autocomplete@2.7.3_react@18.2.0/node_modules/react-google-autocomplete/lib/usePlacesAutocompleteService.js";import"../utils/myDay.js";import{useGetField as l}from"./use-get-field.js";import"../node_modules/.pnpm/numeral@2.0.6/node_modules/numeral/numeral.js";import{uuidv4 as a}from"../utils/uuidv4.js";import d from"../components/form/form-provider.js";import u from"../node_modules/.pnpm/@mui_material@5.15.5_@emotion_react@11.5.0_@emotion_styled@11.6.0_@types_react@18.2.51_react-dom@18.2.0_react@18.2.0/node_modules/@mui/material/styles/styled.js";import c from"../node_modules/.pnpm/@mui_lab@5.0.0-alpha.142_@emotion_react@11.5.0_@emotion_styled@11.6.0_@mui_material@5.15.5_@t_qlw3gtmosftpd3vouevelhzhaq/node_modules/@mui/lab/LoadingButton/LoadingButton.js";const p=u(c)((()=>({backgroundColor:"rgba(34, 197, 94, 0.16)",color:"#118D57","&:hover":{backgroundColor:"rgba(34, 197, 94, 0.36)"}})));function f(u,c={}){const{onSubmit:f,formPrefix:_="",sx:g={},mode:j="onChange"}=c;let h={};const[y,b]=i("0"),x=m((()=>u),[u]);let v={};Object.entries(x).forEach((([e,o])=>{const{schema:t,defaultValue:r="",name:i=e,prefix:m=(_?[_]:""),fieldConfig:s={}}=o;let l=i;const{required:a}=s;if(m){let e="";e=Array.isArray(m)?[...m].join("."):m,h[e]||(h[e]={}),h[e][l]=r}else{let e=v,o=h,m=l.split(".");m.forEach(((s,l)=>{l!=m.length-1?(o[s]||(e[s]={},o[s]={}),e=e[s],o=o[s]):(o[s]=r,t?e[s]=t:a&&(e[s]=n.string().required(i+" is required")))}))}}));let w=(e,o,t=null)=>{let r={...e};for(let e in r)"object"!=typeof r[e]||r[e]instanceof n.Schema||w(r[e],o?o+"."+e:e,r);if(o){let e=o.split(".");e.length>1?t[e.slice(-1)[0]]=n.object(r):v[e.slice(-1)[0]]=n.object(r)}};w(v,"",v);const q=n.object().shape(v),C=s({resolver:o(q),defaultValues:h,mode:j}),{watch:k,handleSubmit:S,formState:{isSubmitting:z}}=C,F=l(C),O=m((()=>Object.entries(x).map((([o,t])=>"custom"==t.type?t.customForm?.()||e.jsx(e.Fragment,{}):e.jsx(r.Fragment,{children:F(t.name||o,{prefix:_?[_]:"",...t})},o)))),[y,x]);return r.useEffect((()=>{const e=k(((e,o)=>{Object.entries(x).map((([t,r])=>{if(r.fieldConfig?.childFieldConfig)for(const t of Object.values(r.fieldConfig?.childFieldConfig))t.watch&&(t.watch?.({currentConfig:t,values:e,info:o,api:C}),b(a()));r.watch&&(r.watch?.({currentConfig:r,values:e,info:o,api:C}),b(a()))}))}));return()=>e.unsubscribe()}),[k,x]),{formNode:m((()=>e.jsx(d,{onSubmit:S((()=>{})),formRef:C,children:e.jsxs(t,{sx:g,spacing:3,children:[O,f&&e.jsx(p,{type:"submit",variant:"contained",size:"large",onClick:async()=>{const e=await C.trigger();f({isRight:e,values:C.getValues(),formRef:C})},loading:z,children:"Save"})]})})),[y,O]),methods:C}}export{f as useFields};
