import{j as e}from"../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js";import{Stack as o,Button as i,Typography as t,IconButton as r}from"@mui/material";import{useState as l,useEffect as n}from"react";import{useFormContext as s,Controller as a}from"../../node_modules/.pnpm/react-hook-form@7.50.1_react@18.2.0/node_modules/react-hook-form/dist/index.esm.js";import"../../hooks/use-fields.js";import{useGetField as d}from"../../hooks/use-get-field.js";import"../../utils/myDay.js";import"../../utils/highlight.js";import"../../node_modules/.pnpm/numeral@2.0.6/node_modules/numeral/numeral.js";import{uuidv4 as m}from"../../utils/uuidv4.js";import{Iconify as c}from"../iconify/iconify.js";import"../image/image.js";import"../upload/upload-drag/cropModal.js";import"../editor/index.js";import"../../node_modules/.pnpm/react-google-autocomplete@2.7.3_react@18.2.0/node_modules/react-google-autocomplete/lib/usePlacesAutocompleteService.js";function p(p){const{name:u,mulType:f="one",addLabel:h,itemFieldConfig:x,childFieldConfig:g}=p,{setValue:j,getValues:$,unregister:k,register:b}=s(),{control:y}=s();let C=$(u);const[_,w]=l([{id:m(),label:u}]);n((()=>{C&&Array.isArray(C)&&w(C?.map?.((()=>({id:m(),label:u}))))}),[]);const D=d();let F;const V=_.map(((i,t)=>{const{id:l}=i;let n,s=`${u}.${t}`;if("one"==f)n=D(s,g||{label:x?.placeholder||x?.label,fieldConfig:x||p}),F=e.jsxs(o,{sx:{marginBottom:"10px"},direction:"row",children:[n,e.jsx(r,{sx:{width:"51px",height:"51px"},onClick:e=>{if(_.length<=1)return;let o=[..._];const i=_.findIndex((e=>e.id===l));o.splice(i,1);let t=[...$(u)];t.splice(i,1),k(`${u}`,{keepDefaultValue:!1,keepDirty:!1});for(let e in o)k(`${u}.${e}`,{keepDefaultValue:!1,keepDirty:!1});b(`${u}`);for(let e in o)b(`${u}.${e}`);j(`${u}`,t),t.forEach(((e,o)=>{j(`${u}.${o}`,e)})),w(o)},children:e.jsx(c,{icon:"icon-park-outline:delete"})})]},l);else{if(!g)return e.jsx(e.Fragment,{children:"error"});n=Object.entries(g).map((([i,r])=>{r.name=`${s}.${i}`;let l={...r};return r.labelMap?.[t]&&(l.label=r.labelMap?.[t]),e.jsx(o,{sx:{mb:2,width:"100%"},direction:"row",children:D(`${s}.${i}`,l)},r.name)})),F=e.jsxs(o,{sx:{width:"100%"},children:[n,e.jsx(o,{sx:{width:"100%",mb:2},direction:"row",children:e.jsx(r,{sx:{},onClick:e=>{if(_.length<=1)return;let o=[..._];const i=_.findIndex((e=>e.id===l));o.splice(i,1);let t=[...$(u)];t.splice(i,1);for(let e in o)k(`${u}.${e}`,{keepDefaultValue:!1,keepDirty:!1});for(let e in o)b(`${u}.${e}`);j(`${u}`,t),t.forEach(((e,o)=>{j(`${u}.${o}`,e)})),w(o)},children:e.jsx(c,{icon:"icon-park-outline:delete"})})})]},l)}return F}));return e.jsx(e.Fragment,{children:e.jsx(a,{name:u,control:y,render:({fieldState:{error:o}})=>e.jsxs(e.Fragment,{children:[V,e.jsx("div",{children:e.jsx(i,{onClick:e=>{w([..._,{id:m(),label:u}])},startIcon:e.jsx(c,{color:"#256CCB",width:"32px",height:"32px",icon:"formkit:add"}),children:e.jsx(t,{fontSize:"14px",color:"#256CCB",children:h||`add ${u}`})})}),(o?.root?.message||o?.message)&&e.jsx("div",{style:{color:"#FF5630",lineHeight:1.5,fontSize:"0.75rem",fontWeight:400,textAlign:"left",marginRight:"14px",marginBottom:"0",marginLeft:"14px"},children:o?.message||o?.root?.message})]})})})}export{p as default};
